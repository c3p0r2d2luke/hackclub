<h1>Admin Approval</h1>
<form id="adminLogin">
Password: <input name="password" type="password" required/>
<button>Login</button>
</form>
<div id="pendingList"></div>
<script src="js/js.cookie.min.js"></script>
<script>
const form = document.getElementById('adminLogin');
form.addEventListener('submit', async e=>{
e.preventDefault();
const password = e.target.password.value;
const res = await fetch('/.netlify/functions/getPending');
const pending = await res.json();
const listDiv = document.getElementById('pendingList');
listDiv.innerHTML='';
pending.forEach(i=>{
const div=document.createElement('div');
div.className='item';
div.innerHTML=`<h2>${i.title}</h2><img src="images/${i.image}"/><p>${i.description}</p><p>Price: $${i.price}</p>
<button onclick="approve('${i.id}','${password}')">Approve</button>
<button onclick="reject('${i.id}','${password}')">Reject</button>`;
listDiv.appendChild(div);
});
});
async function approve(id,password){
await fetch('/.netlify/functions/adminApprove', {
method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({itemId:id,password})
});
alert('Approved'); location.reload();
}
async function reject(id,password){
await fetch('/.netlify/functions/adminReject', {
method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({itemId:id,password})
});
alert('Rejected'); location.reload();
}
</script>
